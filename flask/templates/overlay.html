<!DOCTYPE html>

<html>

    <head>

        <title>ScoreBox Football Overlay</title>

        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <link rel="stylesheet" href="/static/overlay.css">

    </head>

    <body>

        <div class="alert-box team-flag home-alert animate-out" id="home-flag">
        </div>

        <div class="alert-box team-flag visitor-alert animate-out" id="visitor-flag">
        </div>

        <div class="alert-box hidden animate-out" id="neutral-alert">
        </div>

        <div class="alert-box team-alert home-alert bg {{home_color}} hidden animate-out" id="home-alert">
        </div>

        <div class="alert-box team-alert visitor-alert bg {{visitor_color}} hidden animate-out" id="visitor-alert">
        </div>

        <div id="scorebox" class="animate-out">
            <div id="home" class="team-box {{home_color}}">
                <div class="timeouts">
                    <div class="timeout" id="home-timeout-1"></div>
                    <div class="timeout" id="home-timeout-2"></div>
                    <div class="timeout" id="home-timeout-3"></div>
                </div>
                <div class="team-logo">
                </div>
                <div class="team-name">
                    {{home_name}}
                </div>
                <div class="team-mascot">
                    {{home_mascot}}
                </div>
                <div class="team-score" id="home-score">
                    0
                </div>
            </div>
            <div id="clock" class="clock-box">
                <div id="game-clock">
                    4:29
                </div>
                <div id="shot-clock">
                    14
                </div>
                <div id="period">
                    1st
                </div>
                <div id="downs">
                    5th & 24
                </div>
                <div id="home-possesion" class="possesion hide"></div>
                <div id="visitor-possesion" class="possesion hide"></div>
            </div>
            <div id="visitor" class="team-box {{visitor_color}}">
                <div class="team-logo">
                </div>
                <div class="team-name">
                    {{visitor_name}}
                </div>
                <div class="team-mascot">
                    {{visitor_mascot}}
                </div>
                <div class="team-score" id="visitor-score">
                    0
                </div>
                <div class="timeouts">
                    <div class="timeout" id="visitor-timeout-1"></div>
                    <div class="timeout" id="visitor-timeout-2"></div>
                    <div class="timeout" id="visitor-timeout-3"></div>
                </div>
            </div>
        </div>

        <div id="flag-overlay" class="hidden animate-out">
            FLAG
        </div>

        <div class="touchdown {{home_color}} animate-out" id="home-touchdown">
            <span class='letter-spacing-bug'>.</span>TOUCHDOWN
        </div>

        <div class="touchdown {{visitor_color}} animate-out" id="visitor-touchdown">
            <span class='letter-spacing-bug'>.</span>TOUCHDOWN
        </div>

        <div id="scorestate" class="animate-out out">
            <div class="summary-box {{home_color}}">
                <div class="home summary-logo"></div>
                <div class="summary-score" id="home-summary-score">0</div>
            </div>
            <div class="summary-box {{visitor_color}}">
                <div class="visitor summary-logo"></div>
                <div class="summary-score" id="visitor-summary-score">2</div>
            </div>
            <div id="summary-tag">
                End of 1st
            </div>
        </div>

        <script src="/static/third-party/socket.io.min.js"></script>
        <script src="/static/overlay.js"></script>
        <script>
        {% if not remote %}
            socket.on('update', payload => {
            homeScore.innerText = payload.home_score
            visitorScore.innerText = payload.visitor_score
            gameClock.innerText = payload.clock
            shotClock.innerText = parseInt(payload.play)

            if (parseInt(payload.play) <= 5)
            {
                shotClock.classList.add('red')
            }
            else
            {
                shotClock.classList.remove('red')
            }

            if (payload.quarter != 0)
            {
                period.innerText = payload.quarter
            }
            else
            {
                period.innerText = ''
            }
            
            if (payload.down != '' && payload.down != '   ')
            {
                downs.innerText = `${payload.down} & ${payload.to_go}`
            }
            else
            {
                downs.innerText = ''
            }
            

            if (statusObject.flag == "console")
            {
                if (payload.flag)
                {
                    scorebox.classList.add('flag')
                    flagOverlay.classList.remove('hidden')
                }
                else
                {
                    scorebox.classList.remove('flag')
                    flagOverlay.classList.add('hidden')
                }
            }    

            if (payload.home_possesion){
                homePossesion.classList.remove('hide')
                visitorPossesion.classList.add('hide')
            }

            if (payload.visitor_possesion){
                homePossesion.classList.add('hide')
                visitorPossesion.classList.remove('hide')
            }

            if (payload.home_timeouts == 3)
            {
                homeTimeout1.classList.add('available')
                homeTimeout2.classList.add('available')
                homeTimeout3.classList.add('available')
            }

            if (payload.home_timeouts == 2)
            {
                homeTimeout1.classList.add('available')
                homeTimeout2.classList.add('available')
                homeTimeout3.classList.remove('available')
            }

            if (payload.home_timeouts == 1)
            {
                homeTimeout1.classList.add('available')
                homeTimeout2.classList.remove('available')
                homeTimeout3.classList.remove('available')
            }

            if (payload.home_timeouts == 0)
            {
                homeTimeout1.classList.remove('available')
                homeTimeout2.classList.remove('available')
                homeTimeout3.classList.remove('available')
            }

            if (payload.visitor_timeouts == 3)
            {
                visitorTimeout1.classList.add('available')
                visitorTimeout2.classList.add('available')
                visitorTimeout3.classList.add('available')
            }

            if (payload.visitor_timeouts == 2)
            {
                visitorTimeout1.classList.add('available')
                visitorTimeout2.classList.add('available')
                visitorTimeout3.classList.remove('available')
            }

            if (payload.visitor_timeouts == 1)
            {
                visitorTimeout1.classList.add('available')
                visitorTimeout2.classList.remove('available')
                visitorTimeout3.classList.remove('available')
            }

            if (payload.visitor_timeouts == 0)
            {
                visitorTimeout1.classList.remove('available')
                visitorTimeout2.classList.remove('available')
                visitorTimeout3.classList.remove('available')
            }


        })
        {% else %}
            source = io("{{source}}:9876")
            source.on('update', payload => {
            homeScore.innerText = payload.home_score
            visitorScore.innerText = payload.visitor_score
            gameClock.innerText = payload.clock
            shotClock.innerText = parseInt(payload.play)

            if (parseInt(payload.play) <= 5)
            {
                shotClock.classList.add('red')
            }
            else
            {
                shotClock.classList.remove('red')
            }

            if (payload.quarter != 0)
            {
                period.innerText = payload.quarter
            }
            else
            {
                period.innerText = ''
            }
            
            if (payload.down != '' && payload.down != '   ')
            {
                downs.innerText = `${payload.down} & ${payload.to_go}`
            }
            else
            {
                downs.innerText = ''
            }
            

            if (statusObject.flag == "console")
            {
                if (payload.flag)
                {
                    scorebox.classList.add('flag')
                    flagOverlay.classList.remove('hidden')
                }
                else
                {
                    scorebox.classList.remove('flag')
                    flagOverlay.classList.add('hidden')
                }
            }    

            if (payload.home_possesion){
                homePossesion.classList.remove('hide')
                visitorPossesion.classList.add('hide')
            }

            if (payload.visitor_possesion){
                homePossesion.classList.add('hide')
                visitorPossesion.classList.remove('hide')
            }

            if (payload.home_timeouts == 3)
            {
                homeTimeout1.classList.add('available')
                homeTimeout2.classList.add('available')
                homeTimeout3.classList.add('available')
            }

            if (payload.home_timeouts == 2)
            {
                homeTimeout1.classList.add('available')
                homeTimeout2.classList.add('available')
                homeTimeout3.classList.remove('available')
            }

            if (payload.home_timeouts == 1)
            {
                homeTimeout1.classList.add('available')
                homeTimeout2.classList.remove('available')
                homeTimeout3.classList.remove('available')
            }

            if (payload.home_timeouts == 0)
            {
                homeTimeout1.classList.remove('available')
                homeTimeout2.classList.remove('available')
                homeTimeout3.classList.remove('available')
            }

            if (payload.visitor_timeouts == 3)
            {
                visitorTimeout1.classList.add('available')
                visitorTimeout2.classList.add('available')
                visitorTimeout3.classList.add('available')
            }

            if (payload.visitor_timeouts == 2)
            {
                visitorTimeout1.classList.add('available')
                visitorTimeout2.classList.add('available')
                visitorTimeout3.classList.remove('available')
            }

            if (payload.visitor_timeouts == 1)
            {
                visitorTimeout1.classList.add('available')
                visitorTimeout2.classList.remove('available')
                visitorTimeout3.classList.remove('available')
            }

            if (payload.visitor_timeouts == 0)
            {
                visitorTimeout1.classList.remove('available')
                visitorTimeout2.classList.remove('available')
                visitorTimeout3.classList.remove('available')
            }


        })
        {% endif %}
        </script>

    </body>

</html>